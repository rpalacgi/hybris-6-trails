def config = {
	localProperties {
		property 'googleApiKey', ''
		property 'website.powertools.http', 'http://powertools.local:9001/yb2bacceleratorstorefront'
		property 'website.powertools.https', 'https://powertools.local:9002/yb2bacceleratorstorefront'
		property 'build.parallel','true'
		property 'db.url','jdbc:mysql://localhost/coppytrails'
		property 'db.username','coppytrails'
		property 'db.password','coppytrails'
		property 'db.driver','com.mysql.jdbc.Driver'
		property 'tomcat.debugjavaoptions','-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=8000 -XXaltjvm=dcevm -javaagent:"/home/philip/Projects/utils/hotswap/hotswap-agent.jar"=disablePlugin=ZK'
		property 'servicelayer.prefetch','literal'
		}

		extensions {
				extName 'mcc'
				extName 'backoffice'
				extName 'commercesearchbackoffice'
				extName 'b2bcommercebackoffice'
				extName 'commerceservicesbackoffice'
				extName 'solrfacetsearchbackoffice'
				extName 'b2badmincockpit'

				extName 'yacceleratorcockpits'
				extName 'yacceleratorinitialdata'
				extName 'yacceleratorfulfilmentprocess'
				extName 'yaddon'
				extName 'ycommercewebservices'
		
				extName 'powertoolsstore'
				extName 'solrserver'
				
				extName 'acceleratorwebservicesaddon'
				extName 'b2bacceleratoraddon'
				extName 'commerceorgaddon'
				
				extName 'customersupportbackoffice'

				extName 'rulebuilderbackoffice'
				extName 'promotionenginebackoffice'
				extName 'droolsruleengineservices'
				extName 'promotionenginesamplesaddon'
		}
}

task setup << {
  	apply plugin: 'installer-platform-plugin'
  	apply plugin: 'installer-addon-plugin'
  	def pl = platform(config)
  	pl.setup()
	
  	pl.executeAntTarget 'extgen -Dinput.template=yacceleratorstorefront -Dinput.name=yb2bacceleratorstorefront -Dinput.package=de.hybris.platform.yb2bacceleratorstorefront'
	
  	pl.extensions {
  		extName 'yb2bacceleratorstorefront'
  	}
  	pl.setup()
	
  	pl.project.addons {
  			names "b2bacceleratoraddon,commerceorgaddon,promotionenginesamplesaddon"
  			template "yacceleratorstorefront"
  			storeFronts "yb2bacceleratorstorefront"
  			platform pl
  	}

  	pl.project.addons {
  			names "acceleratorwebservicesaddon"
  			template "ycommercewebservices"
  			storeFronts "ycommercewebservices"
  			platform pl
  	}
}

task initialize << {
		apply plugin: 'installer-platform-plugin'
		def pl = platform(config)
		pl.build()
		pl.initialize()
}


task start << {
		apply plugin: 'installer-platform-plugin'
		def pl = platform(config)
		pl.start()
}
